<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>运输业务利润测算工具</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            color: #333;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 20px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
            font-weight: bold;
        }
        .required {
            background-color: #ffffcc; /* 黄色背景 */
        }
        .optional {
            background-color: #e6ffe6; /* 绿色背景 */
        }
        .result {
            background-color: #e6f7ff;
            font-weight: bold;
        }
        .input-field {
            width: 100%;
            padding: 5px;
            box-sizing: border-box;
        }
        .section-header {
            background-color: #2c3e50;
            color: white;
            font-weight: bold;
        }
        .calc-btn {
            display: block;
            width: 200px;
            margin: 20px auto;
            padding: 10px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }
        .calc-btn:hover {
            background-color: #2980b9;
        }
        .notes {
            font-size: 0.9em;
            color: #666;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>运输业务利润测算工具</h1>
        
        <div>
            <label for="customer">客户名称：</label>
            <input type="text" id="customer" value="陕西****公司" class="input-field">
        </div>
        
        <div>
            <label for="shippingFrom">发货地：</label>
            <input type="text" id="shippingFrom" value="郭家河" class="input-field">
            
            <label for="shippingTo">收货地：</label>
            <input type="text" id="shippingTo" value="凤翔" class="input-field">
        </div>
        
        <table>
            <tr>
                <th width="25%">项目</th>
                <th width="25%">明细</th>
                <th width="30%">业务情况</th>
                <th width="20%">计算结果</th>
            </tr>
            
            <!-- 一、运输 -->
            <tr class="section-header">
                <td colspan="4">一、运输</td>
            </tr>
            <tr>
                <td rowspan="7">运输</td>
                <td>发卡类型</td>
                <td>
                    <select id="cardType" class="input-field">
                        <option value="气卡" selected>气卡</option>
                        <option value="油卡">油卡</option>
                    </select>
                </td>
                <td></td>
            </tr>
            <tr>
                <td class="required">发卡比例</td>
                <td><input type="number" id="cardRatio" value="0" min="0" max="30" class="input-field"> %</td>
                <td></td>
            </tr>
            <tr>
                <td>税率</td>
                <td id="taxRate">9%</td>
                <td></td>
            </tr>
            <tr>
                <td>发卡进项</td>
                <td id="cardInputTax">0.00</td>
                <td></td>
            </tr>
            <tr>
                <td class="required">月运量（吨）</td>
                <td><input type="number" id="monthlyVolume" value="33" class="input-field"></td>
                <td></td>
            </tr>
            <tr>
                <td class="required">司机运价（元/吨）</td>
                <td><input type="number" id="driverPrice" value="86.88" class="input-field"></td>
                <td></td>
            </tr>
            <tr>
                <td>开票成本</td>
                <td><input type="number" id="invoiceCost" value="5.5" class="input-field"> %</td>
                <td></td>
            </tr>
            
            <!-- 二、装卸费 -->
            <tr class="section-header">
                <td colspan="4">二、装卸费</td>
            </tr>
            <tr>
                <td rowspan="3">装卸费</td>
                <td class="required">装卸单价（元/吨）</td>
                <td><input type="number" id="handlingPrice" value="100" class="input-field"></td>
                <td></td>
            </tr>
            <tr>
                <td>发票类型</td>
                <td>
                    <select id="invoiceType" class="input-field">
                        <option value="3%的专票" selected>税率3%的专票</option>
                        <option value="其他">其他</option>
                    </select>
                </td>
                <td></td>
            </tr>
            <tr>
                <td>进项税</td>
                <td id="handlingInputTax">2.91</td>
                <td></td>
            </tr>
            
            <!-- 三、居间费 -->
            <tr class="section-header">
                <td colspan="4">三、居间费</td>
            </tr>
            <tr>
                <td>居间费</td>
                <td class="optional">居间单价（元/吨）</td>
                <td><input type="number" id="brokeragePrice" value="0" class="input-field"></td>
                <td></td>
            </tr>
            
            <!-- 四、信息费 -->
            <tr class="section-header">
                <td colspan="4">四、信息费</td>
            </tr>
            <tr>
                <td rowspan="3">信息费</td>
                <td class="optional">信息费（元/车）</td>
                <td><input type="number" id="infoFeePerTruck" value="0" class="input-field"></td>
                <td></td>
            </tr>
            <tr>
                <td class="required">单车吨位（吨/车）</td>
                <td><input type="number" id="tonPerTruck" value="33" class="input-field"></td>
                <td></td>
            </tr>
            <tr>
                <td>信息费（元/吨）</td>
                <td id="infoFeePerTon">0.00</td>
                <td></td>
            </tr>
            
            <!-- 五、人力投入 -->
            <tr class="section-header">
                <td colspan="4">五、人力投入</td>
            </tr>
            <tr>
                <td rowspan="3">人力投入</td>
                <td class="optional">投入员工数量</td>
                <td><input type="number" id="staffCount" value="0" class="input-field"></td>
                <td></td>
            </tr>
            <tr>
                <td class="optional">月人工费用（工资社保等）</td>
                <td><input type="number" id="monthlyLaborCost" value="0" class="input-field"> 元/人</td>
                <td>默认8000元/人</td>
            </tr>
            <tr>
                <td>人力投入（元/吨）</td>
                <td id="laborCostPerTon">0.00</td>
                <td></td>
            </tr>
            
            <!-- 六、房租 -->
            <tr class="section-header">
                <td colspan="4">六、房租</td>
            </tr>
            <tr>
                <td rowspan="2">房租</td>
                <td class="optional">房租费用（元/月）</td>
                <td><input type="number" id="monthlyRent" value="0" class="input-field"></td>
                <td></td>
            </tr>
            <tr>
                <td>房租费用（元/吨）</td>
                <td id="rentPerTon">0.00</td>
                <td></td>
            </tr>
            
            <!-- 七、其他投入 -->
            <tr class="section-header">
                <td colspan="4">七、其他投入</td>
            </tr>
            <tr>
                <td rowspan="6">其他投入</td>
                <td class="optional">煤管费（元/吨）</td>
                <td><input type="number" id="coalManagementFee" value="0" class="input-field"></td>
                <td></td>
            </tr>
            <tr>
                <td class="optional">煤质检验费（元/吨）</td>
                <td><input type="number" id="coalInspectionFee" value="0" class="input-field"></td>
                <td></td>
            </tr>
            <tr>
                <td class="optional">其他费用1（元/吨）</td>
                <td><input type="number" id="otherFee1" value="0" class="input-field"></td>
                <td></td>
            </tr>
            <tr>
                <td class="optional">其他费用2（元/吨）</td>
                <td><input type="number" id="otherFee2" value="0" class="input-field"></td>
                <td></td>
            </tr>
            <tr>
                <td>进项税</td>
                <td id="otherInputTax">0.00</td>
                <td></td>
            </tr>
            <tr>
                <td>其他投入合计（元/吨）</td>
                <td id="otherCostTotal">0.00</td>
                <td></td>
            </tr>
            
            <!-- 八、商务费用 -->
            <tr class="section-header">
                <td colspan="4">八、商务费用</td>
            </tr>
            <tr>
                <td rowspan="2">商务费用</td>
                <td class="optional">商务费用（元/月）</td>
                <td><input type="number" id="monthlyBusinessCost" value="0" class="input-field"></td>
                <td></td>
            </tr>
            <tr>
                <td>商务费用（元/吨）</td>
                <td id="businessCostPerTon">0.00</td>
                <td></td>
            </tr>
            
            <!-- 九、垫资利息 -->
            <tr class="section-header">
                <td colspan="4">九、垫资利息</td>
            </tr>
            <tr>
                <td rowspan="6">垫资利息</td>
                <td class="optional">保证金</td>
                <td><input type="number" id="deposit" value="0" class="input-field"></td>
                <td></td>
            </tr>
            <tr>
                <td>月运费垫资</td>
                <td id="monthlyFreightAdvance">0.00</td>
                <td></td>
            </tr>
            <tr>
                <td>其他垫资额</td>
                <td id="otherAdvance">0.00</td>
                <td></td>
            </tr>
            <tr>
                <td class="optional">垫资比例</td>
                <td><input type="number" id="advanceRatio" value="0" class="input-field"> %</td>
                <td></td>
            </tr>
            <tr>
                <td class="optional">垫资周期（天）</td>
                <td><input type="number" id="advancePeriod" value="0" class="input-field"></td>
                <td></td>
            </tr>
            <tr>
                <td>垫资利息（元/吨）</td>
                <td id="advanceInterestPerTon">0.00</td>
                <td></td>
            </tr>
            
            <!-- 十、税费 -->
            <tr class="section-header">
                <td colspan="4">十、税费</td>
            </tr>
            <tr>
                <td rowspan="4">税费</td>
                <td>销项税</td>
                <td id="outputTax">0.00</td>
                <td></td>
            </tr>
            <tr>
                <td>进项税</td>
                <td id="totalInputTax">0.00</td>
                <td></td>
            </tr>
            <tr>
                <td>增值税</td>
                <td id="vat">0.00</td>
                <td></td>
            </tr>
            <tr>
                <td>附加税</td>
                <td id="additionalTax">0.00</td>
                <td></td>
            </tr>
            
            <!-- 十一、承兑利息 -->
            <tr class="section-header">
                <td colspan="4">十一、承兑利息</td>
            </tr>
            <tr>
                <td rowspan="5">承兑利息</td>
                <td class="optional">承兑比例</td>
                <td><input type="number" id="acceptanceRatio" value="0" class="input-field"> %</td>
                <td></td>
            </tr>
            <tr>
                <td>承兑范围</td>
                <td>
                    <select id="acceptanceScope" class="input-field">
                        <option value="1、国股、股份制银行" selected>1、国股、股份制银行</option>
                        <option value="2、大城商行">2、大城商行</option>
                        <option value="3、其他银行">3、其他银行</option>
                    </select>
                </td>
                <td></td>
            </tr>
            <tr>
                <td>承兑期限</td>
                <td>
                    <select id="acceptancePeriod" class="input-field">
                        <option value="1、半年期" selected>1、半年期</option>
                        <option value="2、一年期">2、一年期</option>
                    </select>
                </td>
                <td></td>
            </tr>
            <tr>
                <td>贴现率</td>
                <td id="discountRate">0.00%</td>
                <td></td>
            </tr>
            <tr>
                <td>承兑利息</td>
                <td id="acceptanceInterest">0.00</td>
                <td></td>
            </tr>
            
            <!-- 十二、其他收益 -->
            <tr class="section-header">
                <td colspan="4">十二、其他收益</td>
            </tr>
            <tr>
                <td rowspan="4">其他收益</td>
                <td>增值税返还</td>
                <td id="vatRebate">0.00</td>
                <td></td>
            </tr>
            <tr>
                <td>城建税返还</td>
                <td id="urbanTaxRebate">0.00</td>
                <td></td>
            </tr>
            <tr>
                <td>教育附加返还</td>
                <td id="educationTaxRebate">0.00</td>
                <td></td>
            </tr>
            <tr>
                <td>印花水利返还</td>
                <td id="stampTaxRebate">0.00</td>
                <td></td>
            </tr>
            
            <!-- 十三、园区服务费 -->
            <tr class="section-header">
                <td colspan="4">十三、园区服务费</td>
            </tr>
            <tr>
                <td>园区服务费</td>
                <td>园区服务费(元/吨)</td>
                <td id="parkServiceFee">0.00</td>
                <td></td>
            </tr>
            
            <!-- 十四、盈利 -->
            <tr class="section-header">
                <td colspan="4">十四、盈利</td>
            </tr>
            <tr>
                <td rowspan="4">盈利</td>
                <td class="result">成本价（元/吨）</td>
                <td id="costPrice" class="result">0.00</td>
                <td class="result">重点输出</td>
            </tr>
            <tr>
                <td class="required">报价（元/吨）</td>
                <td><input type="number" id="quotePrice" value="200" class="input-field"></td>
                <td></td>
            </tr>
            <tr>
                <td class="result">毛利（元）</td>
                <td id="grossProfit" class="result">0.00</td>
                <td></td>
            </tr>
            <tr>
                <td class="result">利润率</td>
                <td id="profitMargin" class="result">0.00%</td>
                <td></td>
            </tr>
        </table>
        
        <button class="calc-btn" onclick="calculate()">计算利润</button>
        
        <div class="notes">
            <p><strong>备注：</strong></p>
            <p>1、毛利≧0的报价方可签订合同。</p>
            <p>2、毛利等于0时报价=成本价，即为保本价。</p>
            <p>3、本表适用于大宗自运业务。</p>
            <p>4、标黄单元格为必填项，绿色单元格为选填项。</p>
        </div>
    </div>

    <script>
        function calculate() {
            // 获取输入值
            const cardType = document.getElementById('cardType').value;
            const cardRatio = parseFloat(document.getElementById('cardRatio').value) / 100;
            const monthlyVolume = parseFloat(document.getElementById('monthlyVolume').value);
            const driverPrice = parseFloat(document.getElementById('driverPrice').value);
            const handlingPrice = parseFloat(document.getElementById('handlingPrice').value);
            const brokeragePrice = parseFloat(document.getElementById('brokeragePrice').value);
            const infoFeePerTruck = parseFloat(document.getElementById('infoFeePerTruck').value);
            const tonPerTruck = parseFloat(document.getElementById('tonPerTruck').value);
            const staffCount = parseFloat(document.getElementById('staffCount').value);
            const monthlyLaborCost = parseFloat(document.getElementById('monthlyLaborCost').value) || 8000;
            const monthlyRent = parseFloat(document.getElementById('monthlyRent').value);
            const coalManagementFee = parseFloat(document.getElementById('coalManagementFee').value);
            const coalInspectionFee = parseFloat(document.getElementById('coalInspectionFee').value);
            const otherFee1 = parseFloat(document.getElementById('otherFee1').value);
            const otherFee2 = parseFloat(document.getElementById('otherFee2').value);
            const monthlyBusinessCost = parseFloat(document.getElementById('monthlyBusinessCost').value);
            const deposit = parseFloat(document.getElementById('deposit').value);
            const advanceRatio = parseFloat(document.getElementById('advanceRatio').value) / 100;
            const advancePeriod = parseFloat(document.getElementById('advancePeriod').value);
            const acceptanceRatio = parseFloat(document.getElementById('acceptanceRatio').value) / 100;
            const quotePrice = parseFloat(document.getElementById('quotePrice').value);
            
            // 计算税率
            const taxRate = cardType === "油卡" ? 0.13 : 0.09;
            document.getElementById('taxRate').textContent = (taxRate * 100).toFixed(0) + '%';
            
            // 计算发卡进项
            const cardInputTax = monthlyVolume * driverPrice * cardRatio * taxRate / (1 + taxRate) / monthlyVolume;
            document.getElementById('cardInputTax').textContent = cardInputTax.toFixed(2);
            
            // 计算信息费（元/吨）
            const infoFeePerTon = infoFeePerTruck / tonPerTruck;
            document.getElementById('infoFeePerTon').textContent = infoFeePerTon.toFixed(2);
            
            // 计算人力投入（元/吨）
            const laborCostPerTon = (staffCount * monthlyLaborCost) / monthlyVolume;
            document.getElementById('laborCostPerTon').textContent = laborCostPerTon.toFixed(2);
            
            // 计算房租费用（元/吨）
            const rentPerTon = monthlyRent / monthlyVolume;
            document.getElementById('rentPerTon').textContent = rentPerTon.toFixed(2);
            
            // 计算装卸费进项税
            const handlingInputTax = handlingPrice * 0.03 / (1 + 0.03);
            document.getElementById('handlingInputTax').textContent = handlingInputTax.toFixed(2);
            
            // 计算其他投入合计
            const otherCostTotal = coalManagementFee + coalInspectionFee + otherFee1 + otherFee2;
            document.getElementById('otherCostTotal').textContent = otherCostTotal.toFixed(2);
            
            // 计算商务费用（元/吨）
            const businessCostPerTon = monthlyBusinessCost / monthlyVolume;
            document.getElementById('businessCostPerTon').textContent = businessCostPerTon.toFixed(2);
            
            // 计算垫资相关
            const monthlyFreightAdvance = driverPrice * monthlyVolume;
            document.getElementById('monthlyFreightAdvance').textContent = monthlyFreightAdvance.toFixed(2);
            
            const otherAdvance = (handlingPrice + brokeragePrice + infoFeePerTon + laborCostPerTon + rentPerTon + businessCostPerTon) * monthlyVolume;
            document.getElementById('otherAdvance').textContent = otherAdvance.toFixed(2);
            
            const totalAdvance = deposit + monthlyFreightAdvance * advanceRatio + otherAdvance * advanceRatio;
            const advanceInterestPerTon = totalAdvance * 0.12 / 360 * advancePeriod / monthlyVolume;
            document.getElementById('advanceInterestPerTon').textContent = advanceInterestPerTon.toFixed(2);
            
            // 计算税费
            const outputTax = (quotePrice * monthlyVolume) / 1.09 * 0.09;
            document.getElementById('outputTax').textContent = outputTax.toFixed(2);
            
            const totalInputTax = cardInputTax * monthlyVolume + handlingInputTax * monthlyVolume;
            document.getElementById('totalInputTax').textContent = totalInputTax.toFixed(2);
            
            const vat = outputTax - totalInputTax;
            document.getElementById('vat').textContent = vat.toFixed(2);
            
            const additionalTax = vat * 0.12 + (quotePrice * monthlyVolume) / 1.09 * 0.0009;
            document.getElementById('additionalTax').textContent = additionalTax.toFixed(2);
            
            // 计算承兑利息
            const acceptanceScope = document.getElementById('acceptanceScope').value;
            const acceptancePeriodSelect = document.getElementById('acceptancePeriod').value;
            
            let baseDiscountRate;
            if (acceptanceScope === "1、国股、股份制银行") {
                baseDiscountRate = 0.011;
            } else if (acceptanceScope === "2、大城商行") {
                baseDiscountRate = 0.012;
            } else {
                baseDiscountRate = 0.013;
            }
            
            let discountRate;
            if (acceptancePeriodSelect === "1、半年期") {
                discountRate = baseDiscountRate * 1.1;
            } else {
                discountRate = baseDiscountRate * 1.1 * 2;
            }
            
            document.getElementById('discountRate').textContent = (discountRate * 100).toFixed(2) + '%';
            
            const acceptanceInterest = quotePrice * monthlyVolume * acceptanceRatio * discountRate;
            document.getElementById('acceptanceInterest').textContent = acceptanceInterest.toFixed(2);
            
            // 计算其他收益
            const vatRebate = vat * 0.5 * 0.9;
            document.getElementById('vatRebate').textContent = vatRebate.toFixed(2);
            
            const urbanTaxRebate = vat * 0.07 * 0.9;
            document.getElementById('urbanTaxRebate').textContent = urbanTaxRebate.toFixed(2);
            
            const educationTaxRebate = vat * 0.05 * 0.9 * 0.9;
            document.getElementById('educationTaxRebate').textContent = educationTaxRebate.toFixed(2);
            
            const stampTaxRebate = quotePrice * monthlyVolume * 0.0003 * 0.9;
            document.getElementById('stampTaxRebate').textContent = stampTaxRebate.toFixed(2);
            
            // 计算园区服务费
            const parkServiceFee = quotePrice * 0.003;
            document.getElementById('parkServiceFee').textContent = parkServiceFee.toFixed(2);
            
            // 计算成本价
            const costPrice = driverPrice + 
                             handlingPrice + 
                             brokeragePrice + 
                             infoFeePerTon + 
                             laborCostPerTon + 
                             rentPerTon + 
                             otherCostTotal + 
                             businessCostPerTon + 
                             advanceInterestPerTon + 
                             vat / monthlyVolume + 
                             additionalTax / monthlyVolume + 
                             acceptanceInterest / monthlyVolume -
                             (vatRebate + urbanTaxRebate + educationTaxRebate + stampTaxRebate) / monthlyVolume +
                             parkServiceFee;
            
            document.getElementById('costPrice').textContent = costPrice.toFixed(2);
            
            // 计算毛利和利润率
            const grossProfit = quotePrice - costPrice;
            document.getElementById('grossProfit').textContent = grossProfit.toFixed(2);
            
            const profitMargin = (grossProfit / quotePrice) * 100;
            document.getElementById('profitMargin').textContent = profitMargin.toFixed(2) + '%';
        }
        
        // 页面加载时自动计算一次
        window.onload = calculate;
    </script>
</body>
</html>